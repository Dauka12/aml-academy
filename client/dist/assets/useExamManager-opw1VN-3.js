import{b7 as D,b8 as L,r as m,b2 as E,j as t,ao as d,E as F,b3 as N,bg as S,ar as f,dx as W,bv as be,d2 as x,b5 as M,d3 as w,de as he,dd as xe,ag as O,ah as V,o as R,c as K,dy as G,bp as y,cW as X,bj as Y,b as ge,ap as ye}from"./index-D4Bdz1nj.js";import{f as _}from"./dateUtils-CDTve7xg.js";import{C as J}from"./CardContent-DoL3pAk8.js";import{T as ve,u as Ce}from"./useTestSessionManager-DlMumwQz.js";import{D as Z}from"./Divider-DeD64mju.js";import{f as je,b as Se,d as Pe,e as Te,s as ke,h as we,u as Re,i as $e}from"./OlympiadRoutes-CIFEOQ9L.js";function Me(e){return D("MuiCardActions",e)}L("MuiCardActions",["root","spacing"]);const Ae=e=>{const{classes:r,disableSpacing:a}=e;return N({root:["root",!a&&"spacing"]},Me,r)},Ie=d("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),ee=m.forwardRef(function(r,a){const o=E({props:r,name:"MuiCardActions"}),{disableSpacing:n=!1,className:l,...p}=o,i={...o,disableSpacing:n},u=Ae(i);return t.jsx(Ie,{className:F(u.root,l),ownerState:i,ref:a,...p})});function Be(e){return D("MuiCardHeader",e)}const $=L("MuiCardHeader",["root","avatar","action","content","title","subheader"]),He=e=>{const{classes:r}=e;return N({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Be,r)},ze=d("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>[{[`& .${$.title}`]:r.title},{[`& .${$.subheader}`]:r.subheader},r.root]})({display:"flex",alignItems:"center",padding:16}),De=d("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,r)=>r.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),Le=d("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,r)=>r.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Ee=d("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,r)=>r.content})({flex:"1 1 auto",[`.${W.root}:where(& .${$.title})`]:{display:"block"},[`.${W.root}:where(& .${$.subheader})`]:{display:"block"}}),re=m.forwardRef(function(r,a){const o=E({props:r,name:"MuiCardHeader"}),{action:n,avatar:l,component:p="div",disableTypography:i=!1,subheader:u,subheaderTypographyProps:P,title:h,titleTypographyProps:g,slots:v={},slotProps:s={},...b}=o,c={...o,component:p,disableTypography:i},C=He(c),j={slots:v,slotProps:{title:g,subheader:P,...s}};let T=h;const[ae,oe]=S("title",{className:C.title,elementType:f,externalForwardedProps:j,ownerState:c,additionalProps:{variant:l?"body2":"h5",component:"span"}});T!=null&&T.type!==f&&!i&&(T=t.jsx(ae,{...oe,children:T}));let k=u;const[se,ne]=S("subheader",{className:C.subheader,elementType:f,externalForwardedProps:j,ownerState:c,additionalProps:{variant:l?"body2":"body1",color:"textSecondary",component:"span"}});k!=null&&k.type!==f&&!i&&(k=t.jsx(se,{...ne,children:k}));const[ie,le]=S("root",{ref:a,className:C.root,elementType:ze,externalForwardedProps:{...j,...b,component:p},ownerState:c}),[ce,de]=S("avatar",{className:C.avatar,elementType:De,externalForwardedProps:j,ownerState:c}),[pe,ue]=S("content",{className:C.content,elementType:Ee,externalForwardedProps:j,ownerState:c}),[me,fe]=S("action",{className:C.action,elementType:Le,externalForwardedProps:j,ownerState:c});return t.jsxs(ie,{...le,children:[l&&t.jsx(ce,{...de,children:l}),t.jsxs(pe,{...ue,children:[T,k]}),n&&t.jsx(me,{...fe,children:n})]})});function Ne(e){return D("MuiLinearProgress",e)}L("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const I=4,B=V`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,Oe=typeof B!="string"?O`
        animation: ${B} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,H=V`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Ve=typeof H!="string"?O`
        animation: ${H} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,z=V`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,qe=typeof z!="string"?O`
        animation: ${z} 3s infinite linear;
      `:null,We=e=>{const{classes:r,variant:a,color:o}=e,n={root:["root",`color${x(o)}`,a],dashed:["dashed",`dashedColor${x(o)}`],bar1:["bar","bar1",`barColor${x(o)}`,(a==="indeterminate"||a==="query")&&"bar1Indeterminate",a==="determinate"&&"bar1Determinate",a==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",a!=="buffer"&&`barColor${x(o)}`,a==="buffer"&&`color${x(o)}`,(a==="indeterminate"||a==="query")&&"bar2Indeterminate",a==="buffer"&&"bar2Buffer"]};return N(n,Ne,r)},q=(e,r)=>e.vars?e.vars.palette.LinearProgress[`${r}Bg`]:e.palette.mode==="light"?he(e.palette[r].main,.62):xe(e.palette[r].main,.5),Ue=d("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`color${x(a.color)}`],r[a.variant]]}})(M(({theme:e})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(e.palette).filter(w()).map(([r])=>({props:{color:r},style:{backgroundColor:q(e,r)}})),{props:({ownerState:r})=>r.color==="inherit"&&r.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),Qe=d("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.dashed,r[`dashedColor${x(a.color)}`]]}})(M(({theme:e})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(e.palette).filter(w()).map(([r])=>{const a=q(e,r);return{props:{color:r},style:{backgroundImage:`radial-gradient(${a} 0%, ${a} 16%, transparent 42%)`}}})]})),qe||{animation:`${z} 3s infinite linear`}),Fe=d("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.bar,r.bar1,r[`barColor${x(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&r.bar1Indeterminate,a.variant==="determinate"&&r.bar1Determinate,a.variant==="buffer"&&r.bar1Buffer]}})(M(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(e.palette).filter(w()).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main}})),{props:{variant:"determinate"},style:{transition:`transform .${I}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${I}s linear`}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:Oe||{animation:`${B} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),Ke=d("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.bar,r.bar2,r[`barColor${x(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&r.bar2Indeterminate,a.variant==="buffer"&&r.bar2Buffer]}})(M(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(e.palette).filter(w()).map(([r])=>({props:{color:r},style:{"--LinearProgressBar2-barColor":(e.vars||e).palette[r].main}})),{props:({ownerState:r})=>r.variant!=="buffer"&&r.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:r})=>r.variant!=="buffer"&&r.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(e.palette).filter(w()).map(([r])=>({props:{color:r,variant:"buffer"},style:{backgroundColor:q(e,r),transition:`transform .${I}s linear`}})),{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:Ve||{animation:`${H} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),Ge=m.forwardRef(function(r,a){const o=E({props:r,name:"MuiLinearProgress"}),{className:n,color:l="primary",value:p,valueBuffer:i,variant:u="indeterminate",...P}=o,h={...o,color:l,variant:u},g=We(h),v=be(),s={},b={bar1:{},bar2:{}};if((u==="determinate"||u==="buffer")&&p!==void 0){s["aria-valuenow"]=Math.round(p),s["aria-valuemin"]=0,s["aria-valuemax"]=100;let c=p-100;v&&(c=-c),b.bar1.transform=`translateX(${c}%)`}if(u==="buffer"&&i!==void 0){let c=(i||0)-100;v&&(c=-c),b.bar2.transform=`translateX(${c}%)`}return t.jsxs(Ue,{className:F(g.root,n),ownerState:h,role:"progressbar",...s,ref:a,...P,children:[u==="buffer"?t.jsx(Qe,{className:g.dashed,ownerState:h}):null,t.jsx(Fe,{className:g.bar1,ownerState:h,style:b.bar1}),u==="determinate"?null:t.jsx(Ke,{className:g.bar2,ownerState:h,style:b.bar2})]})}),U=R(t.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8m.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"}),"AccessTimeOutlined"),Xe=R(t.jsx("path",{d:"M7 15h7v2H7zm0-4h10v2H7zm0-4h10v2H7zm12-4h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-.14 0-.27.01-.4.04-.39.08-.74.28-1.01.55-.18.18-.33.4-.43.64-.1.23-.16.49-.16.77v14c0 .27.06.54.16.78s.25.45.43.64c.27.27.62.47 1.01.55.13.02.26.03.4.03h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7-.25c.41 0 .75.34.75.75s-.34.75-.75.75-.75-.34-.75-.75.34-.75.75-.75M19 19H5V5h14z"}),"AssignmentOutlined"),Ye=R(t.jsx("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday"),_e=R([t.jsx("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),t.jsx("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBookOutlined"),te=R(t.jsx("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82"}),"PlayArrowRounded"),Je=d(X.div)(({theme:e})=>({backgroundColor:"#fff",borderRadius:24,overflow:"hidden",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.08)",height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 16px 32px rgba(0, 0, 0, 0.12)"}})),Ze=d(Y)(({theme:e})=>({borderRadius:14,padding:e.spacing(1.2,2),fontWeight:600,textTransform:"none",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"0 6px 16px rgba(0, 0, 0, 0.16)"}})),Q=d(y)(({theme:e})=>({display:"flex",alignItems:"center",marginBottom:e.spacing(1.5),"&:last-child":{marginBottom:0}})),lr=({session:e})=>{const r=K(),a=()=>e.endTime?new Date(e.endTime)>new Date:!1,o=()=>{const l=a()?`/olympiad/test/${e.id}`:`/olympiad/test-results/${e.id}`;r(l)},n=a();return t.jsx(Je,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:t.jsxs(G,{sx:{boxShadow:"none",height:"100%",display:"flex",flexDirection:"column"},children:[t.jsx(re,{title:e.examData.nameRus,subheader:e.examData.typeRus,titleTypographyProps:{variant:"h6",fontWeight:600},subheaderTypographyProps:{sx:{color:"text.secondary"}}}),t.jsxs(J,{sx:{flexGrow:1,pt:0},children:[t.jsxs(y,{sx:{mb:2},children:[t.jsxs(Q,{children:[t.jsx(Ye,{fontSize:"small",color:"action",sx:{mr:1.5,opacity:.7}}),t.jsxs(f,{variant:"body2",color:"text.secondary",children:["Начало: ",_(e.startTime)]})]}),t.jsxs(Q,{children:[t.jsx(ve,{fontSize:"small",color:"action",sx:{mr:1.5,opacity:.7}}),t.jsxs(f,{variant:"body2",color:"text.secondary",children:["Продолжительность: ",e.examData.durationInMinutes," минут"]})]})]}),t.jsx(Z,{sx:{my:2}}),t.jsx(f,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Статус:"}),t.jsx(y,{sx:{display:"inline-block",py:.5,px:1.5,borderRadius:2,bgcolor:n?"primary.light":"success.light",color:"#fff",fontWeight:500,fontSize:"0.75rem"},children:n?"В процессе":"Завершен"})]}),t.jsx(ee,{sx:{px:2,pb:2},children:t.jsx(Ze,{fullWidth:!0,variant:"contained",color:n?"primary":"secondary",startIcon:n?t.jsx(te,{}):t.jsx(Xe,{}),onClick:o,children:n?"Продолжить тест":"Просмотреть результаты"})})]})})},er=d(X.div)(({theme:e})=>({backgroundColor:"#fff",borderRadius:24,overflow:"hidden",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.08)",height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 16px 32px rgba(0, 0, 0, 0.12)"}})),rr=d(Y)(({theme:e})=>({borderRadius:14,padding:e.spacing(1.2,2),fontWeight:600,textTransform:"none",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"0 6px 16px rgba(0, 0, 0, 0.16)"}})),A=d(y)(({theme:e})=>({display:"flex",alignItems:"center",marginBottom:e.spacing(1.5),"&:last-child":{marginBottom:0}})),cr=({exam:e})=>{var p;const r=K(),{startExamSession:a}=Ce(),[o,n]=m.useState(!1),l=async()=>{try{n(!0);const i=await a(e.id);i.payload&&"id"in i.payload&&r(`/olympiad/test/${i.payload.id}`)}catch(i){console.error("Failed to start exam:",i)}finally{n(!1)}};return t.jsx(er,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:t.jsxs(G,{sx:{boxShadow:"none",height:"100%",display:"flex",flexDirection:"column"},children:[t.jsx(re,{title:e.nameRus,subheader:e.typeRus,titleTypographyProps:{variant:"h6",fontWeight:600},subheaderTypographyProps:{sx:{color:"text.secondary"}}}),t.jsxs(J,{sx:{flexGrow:1,pt:0},children:[t.jsxs(y,{sx:{mb:2},children:[t.jsxs(A,{children:[t.jsx(U,{fontSize:"small",color:"action",sx:{mr:1.5,opacity:.7}}),t.jsxs(f,{variant:"body2",color:"text.secondary",children:["Начало: ",_(e.startTime)]})]}),t.jsxs(A,{children:[t.jsx(U,{fontSize:"small",color:"action",sx:{mr:1.5,opacity:.7}}),t.jsxs(f,{variant:"body2",color:"text.secondary",children:["Продолжительность: ",e.durationInMinutes," минут"]})]})]}),t.jsx(Z,{sx:{my:2}}),t.jsxs(A,{children:[t.jsx(_e,{fontSize:"small",color:"action",sx:{mr:1.5,opacity:.7}}),t.jsxs(f,{variant:"body2",color:"text.secondary",children:["Количество вопросов: ",((p=e.questions)==null?void 0:p.length)||"Загрузка..."]})]}),t.jsxs(y,{mt:2,children:[t.jsx(f,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Статус:"}),t.jsx(y,{sx:{display:"inline-block",py:.5,px:1.5,borderRadius:2,bgcolor:"info.light",color:"#fff",fontWeight:500,fontSize:"0.75rem"},children:"Доступен"})]})]}),t.jsx(ee,{sx:{px:2,pb:2},children:t.jsx(rr,{fullWidth:!0,variant:"contained",color:"primary",startIcon:o?null:t.jsx(te,{}),disabled:o,onClick:l,children:o?t.jsxs(t.Fragment,{children:[t.jsx(Ge,{color:"inherit",sx:{width:20,mr:1}}),"Загрузка..."]}):"Начать тест"})})]})})},dr=()=>{const e=ge(),{exams:r,currentExam:a,loading:o,error:n}=ye(s=>s.exam),l=m.useCallback(()=>e(je()),[e]),p=m.useCallback(s=>e(Se(s)),[e]),i=m.useCallback(s=>e(Pe(s)),[e]),u=m.useCallback(s=>e(Te(s)),[e]),P=m.useCallback(()=>{e(ke(null))},[e]),h=m.useCallback((s,b)=>e(we({questionData:s,testId:b})),[e]),g=m.useCallback((s,b)=>e(Re({questionData:s,id:b})),[e]),v=m.useCallback(s=>e($e(s)),[e]);return{exams:r,currentExam:a,loading:o,error:n,fetchAllExams:l,createExam:p,removeExam:i,selectExam:u,clearSelectedExam:P,createQuestion:h,updateQuestion:g,removeQuestion:v}};export{Xe as A,lr as S,cr as T,dr as u};
