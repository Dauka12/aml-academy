import{bb as k,cU as Y,u as H,j as e,bk as re,bl as ie,bm as te,ar as g,bp as f,bo as se,bj as w,cV as N,c as ae,r as x,cW as C,cX as ne,cY as m,bs as h,cZ as E,c_ as L,bD as O,bC as R,c$ as T,d0 as B,bw as V,bh as oe,aA as le}from"./index-CWPAtMRT.js";import{L as de}from"./LanguageToggle-CI2z1TyJ.js";import{g as ce,r as me,o as ue}from"./OlympiadRoutes-DStoIL9r.js";import{u as xe,a as he}from"./useOlympiadStore-ErJtcenK.js";import{V as $}from"./VisibilityOff-GbgglnEp.js";import{V as G}from"./Visibility-fa_KzF1E.js";import{C as ge}from"./Container-D7Kqj5xH.js";import"./Tooltip-D5k-UFCN.js";const fe=({open:p,onClose:b,onConfirm:I,formData:o,loading:i,categoryName:y})=>{const n=k(),c=Y(n.breakpoints.down("sm")),{t:a}=H(),l=({label:P,value:v})=>e.jsxs(f,{sx:{display:"flex",flexDirection:c?"column":"row",mb:2,"&:last-child":{mb:0}},children:[e.jsx(g,{variant:"subtitle2",sx:{width:c?"100%":"30%",color:"text.secondary",mb:c?.5:0},children:P}),e.jsx(g,{variant:"body1",sx:{fontWeight:500,flexGrow:1},children:v||"â€”"})]});return e.jsxs(re,{open:p,onClose:i?void 0:b,fullWidth:!0,maxWidth:"sm",PaperProps:{sx:{borderRadius:n.shape.borderRadius*2,px:c?1:2}},fullScreen:c,children:[e.jsx(ie,{sx:{pb:1,pt:3,fontSize:"1.5rem",fontWeight:600,textAlign:"center",color:"#1A2751"},children:a("registration.confirmation.title")}),e.jsxs(te,{sx:{px:c?2:4},children:[e.jsx(g,{color:"text.secondary",sx:{mb:3,textAlign:"center",fontSize:"0.95rem"},children:a("registration.confirmation.subtitle")}),e.jsxs(f,{sx:{bgcolor:"rgba(0, 0, 0, 0.02)",p:3,borderRadius:2,mb:2},children:[e.jsx(g,{variant:"h6",sx:{mb:2,fontWeight:600},children:a("registration.confirmation.personalData")}),e.jsx(l,{label:a("registration.fields.lastname"),value:o.lastname}),e.jsx(l,{label:a("registration.fields.firstname"),value:o.firstname}),e.jsx(l,{label:a("registration.fields.middlename"),value:o.middlename}),e.jsx(l,{label:a("registration.fields.iin"),value:o.iin}),e.jsx(l,{label:a("registration.fields.studyYear"),value:o.studyYear})]}),e.jsxs(f,{sx:{bgcolor:"rgba(0, 0, 0, 0.02)",p:3,borderRadius:2,mb:2},children:[e.jsx(g,{variant:"h6",sx:{mb:2,fontWeight:600},children:a("registration.confirmation.contactInfo")}),e.jsx(l,{label:a("registration.fields.email"),value:o.email}),e.jsx(l,{label:a("registration.fields.phone"),value:o.phone}),e.jsx(l,{label:a("registration.fields.university"),value:o.university})]}),e.jsxs(f,{sx:{bgcolor:"rgba(0, 0, 0, 0.02)",p:3,borderRadius:2},children:[e.jsx(g,{variant:"h6",sx:{mb:2,fontWeight:600},children:a("registration.confirmation.participationInfo")}),e.jsx(l,{label:a("registration.fields.category"),value:y})]})]}),e.jsxs(se,{sx:{justifyContent:"center",p:3,gap:2,flexDirection:c?"column":"row"},children:[e.jsx(w,{onClick:b,disabled:i,variant:"outlined",sx:{borderColor:"#1A2751",color:"#1A2751","&:hover":{borderColor:"#1A2751",backgroundColor:"rgba(26, 39, 81, 0.04)"},px:4,py:1,width:c?"100%":"auto"},children:a("registration.confirmation.backButton")}),e.jsx(w,{onClick:I,disabled:i,variant:"contained",sx:{bgcolor:"#1A2751","&:hover":{bgcolor:"#13203f"},px:4,py:1,width:c?"100%":"auto"},startIcon:i?e.jsx(N,{size:20,color:"inherit"}):null,children:a(i?"registration.confirmation.submitting":"registration.confirmation.confirmButton")})]})]})},pe=C(oe),be=()=>{var z,D;const p=ae(),b=xe(),I=k(),o=Y(I.breakpoints.down("sm")),{t:i,i18n:y}=H(),{isLoading:n,success:c,error:a}=he(r=>r.registration),[l,P]=x.useState([]),[v,X]=x.useState(!1),[K,F]=x.useState(!1),[t,S]=x.useState({firstname:"",lastname:"",middlename:"",iin:"",phone:"",studyYear:1,university:"",email:"",password:"",confirmPassword:"",categoryId:0}),[s,M]=x.useState({}),[W,Q]=x.useState(!1),[A,U]=x.useState(!1);x.useEffect(()=>{if(c){const r=setTimeout(()=>{p("/olympiad/login")},2e3);return()=>clearTimeout(r)}},[c,p]),x.useEffect(()=>{(async()=>{try{X(!0);const d=await ce();P(d),d.length>0&&S(j=>({...j,categoryId:d[0].id}))}catch(d){console.error("Failed to fetch categories:",d)}finally{X(!1)}})()},[i]);const Z=()=>{const r={};return t.firstname.trim()||(r.firstname=i("registration.errors.firstnameRequired")),t.lastname.trim()||(r.lastname=i("registration.errors.lastnameRequired")),t.iin.trim()?/^\d{12}$/.test(t.iin)||(r.iin=i("registration.errors.iinFormat")):r.iin=i("registration.errors.iinRequired"),t.phone.trim()?/^\+?[0-9]{10,15}$/.test(t.phone.replace(/\s/g,""))||(r.phone=i("registration.errors.phoneFormat")):r.phone=i("registration.errors.phoneRequired"),t.university.trim()||(r.university=i("registration.errors.universityRequired")),t.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(r.email=i("registration.errors.emailFormat")):r.email=i("registration.errors.emailRequired"),t.password?t.password.length<6&&(r.password=i("registration.errors.passwordLength")):r.password=i("registration.errors.passwordRequired"),t.confirmPassword?t.password!==t.confirmPassword&&(r.confirmPassword=i("registration.errors.passwordsMatch")):r.confirmPassword=i("registration.errors.confirmPasswordRequired"),t.categoryId||(r.categoryId=i("registration.errors.categoryRequired")),M(r),Object.keys(r).length===0},u=r=>{const{name:d,value:j}=r.target;S({...t,[d]:j}),s[d]&&M({...s,[d]:void 0})},q=r=>{const{name:d,value:j}=r.target;d&&S({...t,[d]:j})},_=async r=>{r.preventDefault(),Z()&&F(!0)},J=()=>{const{confirmPassword:r,...d}=t;b(me(d))},ee=l.find(r=>r.id===t.categoryId)?y.language==="kz"?(z=l.find(r=>r.id===t.categoryId))==null?void 0:z.nameKaz:(D=l.find(r=>r.id===t.categoryId))==null?void 0:D.nameRus:"";return e.jsxs(pe,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},elevation:3,sx:{p:o?3:4,maxWidth:800,width:"100%",bgcolor:"rgba(255, 255, 255, 0.9)",borderRadius:2,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",mx:o?2:0},children:[e.jsxs(f,{display:"flex",flexDirection:"column",alignItems:"center",mb:o?3:4,children:[e.jsx(C.div,{initial:{scale:.8},animate:{scale:1},transition:{duration:.5},children:e.jsx(ne,{sx:{fontSize:o?50:60,color:"#f5b207",mb:2}})}),e.jsx(g,{component:"h1",variant:o?"h5":"h4",sx:{fontWeight:700,color:"#1A2751",textAlign:"center",mb:1},children:i("registration.title")}),e.jsx(g,{variant:o?"body2":"subtitle1",sx:{color:"text.secondary",textAlign:"center",maxWidth:"95%"},children:i("registration.subtitle")})]}),e.jsxs("form",{onSubmit:_,children:[e.jsxs(m,{container:!0,spacing:3,children:[e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.lastname"),name:"lastname",variant:"outlined",value:t.lastname,onChange:u,error:!!s.lastname,helperText:s.lastname,disabled:n})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.firstname"),name:"firstname",variant:"outlined",value:t.firstname,onChange:u,error:!!s.firstname,helperText:s.firstname,disabled:n})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.middlename"),name:"middlename",variant:"outlined",value:t.middlename,onChange:u,error:!!s.middlename,helperText:s.middlename,disabled:n})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.iin"),name:"iin",variant:"outlined",value:t.iin,onChange:u,error:!!s.iin,helperText:s.iin,disabled:n,inputProps:{maxLength:12}})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.phone"),name:"phone",variant:"outlined",value:t.phone,onChange:u,error:!!s.phone,helperText:s.phone,disabled:n,placeholder:"+7 (XXX) XXX-XX-XX"})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsxs(E,{fullWidth:!0,error:!!s.studyYear,disabled:n,children:[e.jsx(L,{id:"studyYear-label",children:i("registration.fields.studyYear")}),e.jsx(O,{labelId:"studyYear-label",id:"studyYear",name:"studyYear",value:t.studyYear,onChange:q,label:i("registration.fields.studyYear"),children:[1,2,3,4].map(r=>e.jsx(R,{value:r,children:r},r))}),s.studyYear&&e.jsx(T,{children:s.studyYear})]})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.university"),name:"university",variant:"outlined",value:t.university,onChange:u,error:!!s.university,helperText:s.university,disabled:n})}),e.jsx(m,{item:!0,xs:12,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.email"),name:"email",type:"email",variant:"outlined",value:t.email,onChange:u,error:!!s.email,helperText:s.email,disabled:n})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.password"),name:"password",type:W?"text":"password",variant:"outlined",value:t.password,onChange:u,error:!!s.password,helperText:s.password,disabled:n,InputProps:{endAdornment:e.jsx(B,{position:"end",children:e.jsx(V,{onClick:()=>Q(!W),edge:"end",children:W?e.jsx($,{}):e.jsx(G,{})})})}})}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsx(h,{fullWidth:!0,label:i("registration.fields.confirmPassword"),name:"confirmPassword",type:A?"text":"password",variant:"outlined",value:t.confirmPassword,onChange:u,error:!!s.confirmPassword,helperText:s.confirmPassword,disabled:n,InputProps:{endAdornment:e.jsx(B,{position:"end",children:e.jsx(V,{onClick:()=>U(!A),edge:"end",children:A?e.jsx($,{}):e.jsx(G,{})})})}})}),e.jsx(m,{item:!0,xs:12,children:e.jsxs(E,{fullWidth:!0,error:!!s.categoryId,disabled:n||v,children:[e.jsx(L,{id:"category-label",children:i("registration.fields.category")}),e.jsx(O,{labelId:"category-label",id:"category",name:"categoryId",value:t.categoryId,onChange:q,label:i("registration.fields.category"),children:v?e.jsx(R,{value:0,disabled:!0,children:i("registration.loading")}):l.map(r=>e.jsx(R,{value:r.id,children:y.language==="kz"?r.nameRus:r.nameKaz},r.id))}),s.categoryId&&e.jsx(T,{children:s.categoryId})]})})]}),a&&e.jsx(f,{mt:2,children:e.jsx(T,{error:!0,children:a})}),e.jsxs(f,{mt:4,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},gap:2,children:[e.jsx(w,{variant:"outlined",onClick:()=>p("/olympiad/login"),disabled:n,sx:{borderColor:"#1A2751",color:"#1A2751","&:hover":{borderColor:"#1A2751",backgroundColor:"rgba(26, 39, 81, 0.04)"},px:4,py:1},children:i("registration.buttons.haveAccount")}),e.jsx(C.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:e.jsx(w,{type:"submit",variant:"contained",disabled:n,sx:{bgcolor:"#1A2751","&:hover":{bgcolor:"#13203f"},px:4,py:1},startIcon:n?e.jsx(N,{size:20,color:"inherit"}):null,children:i(n?"registration.buttons.registering":c?"registration.buttons.registerSuccess":"registration.buttons.register")})})]})]}),e.jsx(fe,{open:K,onClose:()=>F(!1),onConfirm:J,formData:t,loading:n,categoryName:ee})]})},We=()=>{const p=k(),b=Y(p.breakpoints.down("sm"));return e.jsx(le,{store:ue,children:e.jsx(ge,{maxWidth:!1,disableGutters:!0,children:e.jsxs(f,{sx:{width:"100%",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",py:b?3:5,px:b?1:3,backgroundImage:"linear-gradient(135deg, #1A2751 0%, #13203f 100%)",overflowY:"auto"},children:[e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},style:{position:"absolute",top:0,left:0,right:0,bottom:0,opacity:.6}}),e.jsx(de,{}),e.jsx(be,{})]})})})};export{We as default};
