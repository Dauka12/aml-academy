import{a as ze,r as l,u as X,v as Me,c as re,m as Fe,j as e,V as He,H as Ae,bq as ne,br as Ee,aq as $e,bj as Q,F as we,d as w,e as I,bk as Ie,bl as Le,bm as Be,bs as R,bo as qe,bt as y,bu as le}from"./index-CWPAtMRT.js";function Xe(){const{styles:a,open:ee,setOpen:L,userEntry:z,checkStyle:B}=ze(),[C,d]=l.useState(!1),[G,se]=l.useState("standard"),{t:_}=X(),{i18n:n}=X();n.language;const[b,m]=l.useState(!1),[M,p]=l.useState(""),N=()=>{m(!0)},g=()=>{m(!1)};l.useEffect(()=>{(async()=>{try{const s="/api/aml/course/getUserCourses",o="/api/aml/course/getUserCoursesNoPr";let r=null;U!=null?r=await w.get(`${I}${s}`,{headers:{Authorization:`Bearer ${U}`}}):r=await w.get(`${I}${o}`),console.log(r.data);let v=[...r.data];const x={};if(r.status===200){v.forEach(i=>{if(i.courseDTO.type_of_study==="дистанционное"){const c=i.courseDTO.courseCategory.category_name;x[c]||(x[c]=[]),x[c].push(i)}});const h={};v.forEach(i=>{if(i.courseDTO.type_of_study==="онлайн"){const c=i.courseDTO.course_image;h[c]||(h[c]=[]),h[c].push(i)}}),console.log(h),H(x),ae(h),J(r.data),H(x),J(r.data)}else q(r.statusText)}catch(s){q(s),console.error(s)}W(!1)})()},[]);const[u,T]=l.useState(1),O=t=>{const s=document.querySelector(".text-content");s&&s.classList.remove("light-mode","dark-mode","inverted-mode","blue-mode");const{colorMode:o}=a;s&&s.classList.add(o+"-mode")},D=()=>{console.log("OPEN"),ie(t=>!t),L(t=>!t)},[ce,ie]=l.useState(ee),de=()=>{console.log("Images hidden"),d(!0)},ue=()=>{d(!1)},he=Me();l.useEffect(()=>{const t=he.hash;console.log(t),t==="#top"&&window.scrollTo(0,0);const s=document.querySelector(".text-content"),o=a.fontFamily;o&&(s.style.fontFamily=o)},[]);const f={small:{fontSize:"15px",lineHeight:"17px",caption:{fontSize:"26px",lineHeight:"28px"},subtitle:{fontSize:"14px",lineHeight:"16px"}},standard:{fontSize:"16px",lineHeight:"18px",caption:{fontSize:"36px",lineHeight:"38px"},subtitle:{fontSize:"18px",lineHeight:"20px"}},large:{fontSize:"24px",lineHeight:"26px",caption:{fontSize:"39px",lineHeight:"41px"},subtitle:{fontSize:"22px",lineHeight:"24px"}}};l.useEffect(()=>{if(!B||(console.log(z),z))return;const t=document.querySelectorAll(".text-content"),s=a.fontSize;d(!a.showImage),t&&t.forEach(o=>{switch(s){case"small":case"large":o.style.fontSize=f[s].fontSize,o.style.lineHeight=f[s].lineHeight,o.classList.contains("caption")?(o.style.fontSize=f[s].caption.fontSize,o.style.lineHeight=f[s].caption.lineHeight):o.classList.contains("subtitle")&&(o.style.fontSize=f[s].subtitle.fontSize,o.style.lineHeight=f[s].subtitle.lineHeight);break;case"standard":o.classList.contains("caption")?(o.style.fontSize=f[s].caption.fontSize,o.style.lineHeight=f[s].caption.lineHeight):o.classList.contains("subtitle")?(o.style.fontSize=f[s].subtitle.fontSize,o.style.lineHeight=f[s].subtitle.lineHeight):(o.style.fontSize=f[s].fontSize,o.style.lineHeight=f[s].lineHeight);break}}),O()},[B,z,a,d,f]),l.useEffect(()=>{const t=document.querySelector(".text-content"),s=a.fontFamily;s&&(t.style.fontFamily=s)},[]),re();const me=({open:t,handleClose:s,courseId:o,courseName:r})=>{const[v,x]=l.useState(""),[h,i]=l.useState(""),[c,Te]=l.useState(""),ke=()=>{W(!0),console.log("clicked");const j=async()=>{const P=new FormData;P.append("userCourse",JSON.stringify({fio:v,phone_number:h,email:c,progress_percentage:0}));try{const $=await w.post(`${I}/api/aml/course/saveUserRequest/course/${K}`,P,{});console.log(v),alert("Заявка отправлена!!!"),g()}catch($){console.log($),alert("Ошибка")}},E={...M};Object.keys(E).forEach(P=>{E[P].forEach($=>{$.courseDTO.course_id===K&&($.courseDTO.rating+=1)})}),p(E),j(),W(!1)};return e.jsxs(Ie,{open:t,onClose:s,PaperProps:{component:"form",onSubmit:j=>{j.preventDefault();const E=new FormData(j.currentTarget);Object.fromEntries(E.entries()),ke(),s()}},children:[e.jsx(Le,{children:"Подать заявку на курс"}),e.jsxs(Be,{children:[e.jsx(R,{label:"ФИО",value:v,onChange:j=>x(j.target.value),fullWidth:!0,required:!0,id:"fio",margin:"normal"}),e.jsx(R,{label:"Контакты",value:h,onChange:j=>i(j.target.value),fullWidth:!0,id:"contacts",required:!0,margin:"normal"}),e.jsx(R,{required:!0,margin:"normal",id:"email",label:"Электронная почта",value:c,onChange:j=>Te(j.target.value),fullWidth:!0,type:"email"}),e.jsx(R,{label:"Курс",value:r,readOnly:!0,fullWidth:!0,margin:"normal"})]}),e.jsxs(qe,{children:[e.jsx(Q,{onClick:s,color:"primary",children:"Отмена"}),e.jsx(Q,{type:"submit",color:"primary",children:"Отправить"})]})]})},[S,J]=l.useState(null);l.useEffect(()=>{console.log("Число изменилось:",S)},[S]);const[Ue,q]=l.useState(null),[fe,W]=l.useState(!0),[F,H]=l.useState(null);console.log(F);const U=localStorage.getItem("jwtToken"),ge=localStorage.getItem("catalog");console.log(ge);const[K,xe]=l.useState(null),[pe,je]=l.useState(null),[ye,te]=l.useState(!1),[_e,oe]=l.useState(!1),[Ve,be]=l.useState(!1),[Pe,Se]=l.useState(!1),[V,Y]=l.useState(["Все категории"]),[A,ve]=l.useState(""),[Ce,ae]=l.useState(""),{categoryFormat:k,handleChangeCategoryFormat:Z}=Fe();console.log(k);const Ne=t=>{const s=t.target.value;Y(o=>t.target.checked?(o=o.filter(r=>r!=="Все категории"),[...o,s]):o.filter(r=>r!==s))},Oe=t=>{t.target.checked?Y(["Все категории"]):Y([])},De=t=>{ve(t.target.value)};return l.useEffect(()=>{if(S)if(A===""){const t={};S.forEach(s=>{const o=s.courseDTO.courseCategory.category_name;t[o]||(t[o]=[]),t[o].push(s)}),H(t)}else{const t={};S.filter(s=>s.courseDTO.course_name.toLowerCase().indexOf(A.toLowerCase())!=-1||s.courseDTO.courseCategory.category_name.toLowerCase().indexOf(A.toLowerCase())!=-1).forEach(s=>{const o=s.courseDTO.courseCategory.category_name;t[o]||(t[o]=[]),t[o].push(s)}),H(t)}},[A]),l.useEffect(()=>{(async()=>{try{const s="/api/aml/course/getUserCourses",o="/api/aml/course/getUserCoursesNoPr";let r=null;U!=null?r=await w.get(`${I}${s}`,{headers:{Authorization:`Bearer ${U}`}}):r=await w.get(`${I}${o}`),console.log(r.data);let v=[...r.data,{id:0,courseDTO:{course_id:100,course_name:"Учебный модуль по навыкам работы с виртуальными активами",course_price:20001,course_image:"https://amlacademy.kz/aml//cum.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=minioadmin%2F20240515%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240515T133226Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=6b8b1e7d7ba9bee62d2255e729457eace4caeb65bf6d6df62542e0e73e8729ee",course_for_member_of_the_system:"Для правоохранительных органов",duration:"19ч 45мин",rating:5,type_of_study:"дистанционное",courseCategory:{category_id:1,category_image:"https://amlacademy.kz/aml/Screenshot%202023-11-04%20at%2023.43.20.png",minio_image_name:"https://amlacademy.kz/aml/Screenshot%202023-11-04%20at%2023.43.20.png",category_name:"AML ACADEMY"},courseComments:[],course_price_sale:null,group_of_person:null,applied_for_study:null,who_course_intended_for:null},paymentInfo:{progress_percentage:4332.75,payment_type:"KASPI",payment_date:0x9b5f369f00ca,status:"process"},shortStatus:2}];const x={};if(r.status===200){v.forEach(i=>{if(i.courseDTO.type_of_study==="дистанционное"){const c=i.courseDTO.courseCategory.category_name;x[c]||(x[c]=[]),x[c].push(i)}});const h={};v.forEach(i=>{if(i.courseDTO.type_of_study==="онлайн"){const c=i.courseDTO.course_image;h[c]||(h[c]=[]),h[c].push(i)}}),console.log(h),H(x),ae(h),p(h),J(r.data)}else q(r.statusText)}catch(s){q(s),console.error(s)}W(!1)})()},[]),e.jsxs("div",{className:"catalog-page",style:{background:a.colorMode==="dark"?"#000":a.colorMode==="light"?"#fff":a.colorMode==="blue"?"#9dd1ff":"#000",color:a.colorMode==="dark"?"#fff":a.colorMode==="light"?"#343434":a.colorMode==="blue"?"#063462":"#000"},children:[e.jsx(He,{open:ce,onRemoveImages:de,onShowImages:ue,onFontFamily:()=>{},onIntervalChange:()=>{},styles:a}),e.jsx(Ae,{dark:a.colorMode!="dark",handleOpenVisualModal:D}),e.jsx("div",{children:e.jsx("div",{className:"container"})}),e.jsxs("main",{className:"page-content",children:[e.jsx("div",{className:"catalog-header",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"header-title",children:e.jsx("h3",{className:"text-content caption",style:{color:a.colorMode==="dark"?"#fff":a.colorMode==="light"?"#3A3939":a.colorMode==="blue"?"#063462":"#000"},children:_("course catalog")})}),e.jsxs("div",{className:"header-actions",style:{background:a.colorMode==="dark"?"#000":a.colorMode==="light"?"#fff":a.colorMode==="blue"?"#9dd1ff":"#000"},children:[e.jsx("div",{className:"filters",children:e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>{te(t=>!t),be(!1)},children:[e.jsx(ne,{size:20,className:"icon"}),e.jsx("span",{className:"inline-text",style:{color:a.colorMode==="dark"?"#fff":a.colorMode==="light"?"#343434":a.colorMode==="blue"?"#063462":"#000"},children:_("categories")})]}),e.jsxs("div",{className:"categories",style:{display:ye?"flex":"none"},onMouseLeave:()=>{te(!1)},children:[e.jsxs("div",{children:[e.jsx("input",{onChange:Oe,checked:V.includes("Все категории"),type:"checkbox",value:"Все категории"}),e.jsx("label",{className:"inline-text",children:_("all categories")})]}),Object.keys(F||{}).map(t=>{const s=V.includes(t)&&!t.includes("Все категории");return e.jsxs("div",{style:{background:a.colorMode==="dark"?"#000":a.colorMode==="light"?"#f2f2f2":a.colorMode==="blue"?"#9dd1ff":"#000"},children:[e.jsx("input",{onChange:Ne,checked:s,type:"checkbox",value:t}),e.jsx("label",{children:t})]},t)})]})]})}),e.jsx("div",{className:"filters",children:e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>{oe(t=>!t),Se(!1)},children:[e.jsx(ne,{size:20,className:"icon"}),e.jsx("span",{className:"inline-text",style:{color:a.colorMode==="dark"?"#fff":a.colorMode==="light"?"#343434":a.colorMode==="blue"?"#063462":"#000"},children:_("learning format")})]}),e.jsxs("div",{className:"categories",style:{display:_e?"flex":"none"},onMouseLeave:()=>{oe(!1)},children:[e.jsxs("div",{children:[e.jsx("input",{onClick:()=>Z("Онлайн"),checked:k==="Онлайн",type:"checkbox",value:""}),e.jsx("label",{className:"inline-text",children:_("online")})]}),e.jsxs("div",{children:[e.jsx("input",{onClick:()=>Z("Дистанционно"),checked:k==="Дистанционно",type:"checkbox",value:""}),e.jsx("label",{className:"inline-text",children:_("remote")})]}),e.jsxs("div",{children:[e.jsx("input",{onClick:()=>Z("Офлайн"),checked:k==="Офлайн",type:"checkbox",value:""}),e.jsx("label",{className:"inline-text",children:_("offline")})]})]})]})}),e.jsxs("div",{className:"search",style:{background:a.colorMode==="dark"?"#000":a.colorMode==="light"?"#fff":a.colorMode==="blue"?"#9dd1ff":"#000"},children:[e.jsx(Ee,{size:20,className:"icon"}),e.jsx("input",{type:"text",value:A,onChange:De})]})]})]})}),fe?e.jsx("div",{className:"container",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"loading",style:{margin:"20px 0px"},children:[e.jsx("div",{children:"загружаем"}),e.jsx("div",{children:"загружаем"}),e.jsx("div",{children:"загружаем"})]})})}):e.jsx(e.Fragment,{children:F!==null&&e.jsxs(e.Fragment,{children:[k==="Онлайн"&&e.jsx("div",{className:"TableMain",children:e.jsx("table",{className:"CategoryTable",children:e.jsx("div",{className:"TableMain",children:e.jsxs("table",{className:"CategoryTable",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"ColumnNames",children:[e.jsx("th",{children:"Курсы"}),e.jsx("th",{children:"Аудитория"}),e.jsx("th",{children:"Формат"}),e.jsx("th",{children:"Группа"}),e.jsx("th",{children:"Стоимость"}),e.jsx("th",{children:"Стоимость с учетом корпоративной скидки"}),e.jsx("th",{children:"Заявка"})]})}),e.jsx("tbody",{children:S&&(S==null?void 0:S.length)>0?Object.entries(Ce).map(([t,s])=>e.jsxs($e.Fragment,{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"groups",children:t})}),s.filter(o=>o.courseDTO.type_of_study==="онлайн").map(o=>e.jsxs("tr",{className:"Rows",style:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx("td",{children:o.courseDTO.course_name}),e.jsx("td",{children:o.courseDTO.course_for_member_of_the_system}),e.jsx("td",{children:o.courseDTO.type_of_study}),e.jsx("td",{children:o.courseDTO.group_of_person}),e.jsx("td",{children:o.courseDTO.course_price}),e.jsx("td",{children:o.courseDTO.course_price_sale}),e.jsx("td",{children:e.jsx(Q,{onClick:()=>{xe(o.courseDTO.course_id),je(o.courseDTO.course_name),N()},children:"Подать заявку"})})]},o.courseDTO.course_id))]},t)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"Нет данных для отображения"})})})]})})})}),e.jsx(me,{open:b,handleClose:g,courseId:K,courseName:pe}),k==="Дистанционно"&&e.jsx(e.Fragment,{children:Object.keys(F).map(t=>!V.includes("Все категории")&&!V.includes(t)?null:e.jsx(We,{categoryName:t,categoryDesc:t,courses:F[t]},t))})]})})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(we,{})]})}const We=({categoryName:a,categoryDesc:ee,courses:L})=>{const{i18n:z}=X(),B=z.language,C=re(),{t:d}=X(),G=localStorage.getItem("member_of_the_system"),se=L.filter(n=>G!=="Правоохранительные органы"?n.courseDTO.courseCategory.category_name===a&&n.courseDTO.course_for_member_of_the_system!=="Для правоохранительных органов":n.courseDTO.courseCategory.category_name===a),_=L.filter(n=>G!=="Правоохранительные органы"?n.courseDTO.course_for_member_of_the_system==="Для правоохранительных органов":null);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"inline-text",style:{fontFamily:"Ubuntu",fontSize:"20px",fontWeight:"500",lineHeight:"23px",letterSpacing:"0em",textAlign:"left"},children:a}),e.jsx("p",{className:"inline-text",style:{fontFamily:"Ubuntu",fontSize:"16px",fontWeight:"400",lineHeight:"19px",letterSpacing:"0em",textAlign:"left",color:"#656678"},children:d("Для участников системы ПОД/ФТ")})]}),e.jsx("div",{className:"courses-block container",children:se.sort((n,b)=>n.shortStatus-b.shortStatus).map((n,b)=>{var T,O,D;const m=n.courseDTO,{course_image:M,course_name:p}=m,{paymentInfo:N}=n,g=m.group_of_person;var u=N===null?"available":N.status;return m.course_id===86&&(u="free"),e.jsxs("div",{className:`course-card ${g==="soon"?"soon":""}`,onClick:()=>{C((u==="process"||u==="finished")&&g!=="soon"?`/courses/${n.courseDTO.course_id}/read`:g==="soon"?"/courses":`/courses/${n.courseDTO.course_id}`)},children:[e.jsx("div",{className:`soon-text ${g==="soon"?"soon":""}`,children:"Скоро . . ."}),e.jsxs("div",{className:"image",children:[e.jsx("img",{src:M,alt:p}),e.jsx("div",{className:`status ${u}`,children:u==="available"?d("Доступно"):u==="process"?d("В процессе"):u=="free"?d("Бесплатно"):d("Завершен")})]}),e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"course-name",children:p}),e.jsxs("div",{className:"langAndDuration",children:[p==="Базалық курс"||p==='"WEB SFM порталы" модулі'?"ҚАЗ":"РУС"," | ",n.courseDTO.duration]}),e.jsxs("div",{className:"rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23})]}),e.jsx("span",{children:(D=n.courseDTO.rating%1===0?((T=n.courseDTO.rating)==null?void 0:T.toFixed(1))+".0":(O=n.courseDTO.rating)==null?void 0:O.toFixed(1))==null?void 0:D.replace(/\.0$/,"")})]}),e.jsxs("div",{className:"type",children:[e.jsx(le,{size:23}),e.jsx("span",{children:B==="kz"&&m.course_for_member_of_the_system==="Для всех субъектов"?"Барлық субъектілер үшін":m.course_for_member_of_the_system})]})]})]},b)})}),e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"inline-text",style:{fontFamily:"Ubuntu",fontSize:"20px",fontWeight:"500",lineHeight:"23px",letterSpacing:"0em",textAlign:"left"},children:a}),e.jsx("p",{className:"inline-text",style:{fontFamily:"Ubuntu",fontSize:"16px",fontWeight:"400",lineHeight:"19px",letterSpacing:"0em",textAlign:"left",color:"#656678"},children:d("Для правоохранительных органов")})]}),e.jsx("div",{className:"courses-block container",children:_.sort((n,b)=>n.shortStatus-b.shortStatus).map((n,b)=>{var T,O,D;const m=n.courseDTO,{course_image:M,course_name:p}=m,{paymentInfo:N}=n;m.group_of_person;const g=m.course_for_member_of_the_system;var u=N===null?"available":N.status;return m.course_id===86&&(u="free"),e.jsxs("div",{className:`course-card ${g==="Для правоохранительных органов"?"soon":""}`,onClick:()=>{C((u==="process"||u==="finished")&&g!=="Для правоохранительных органов"?`/courses/${n.courseDTO.course_id}/read`:g==="Для правоохранительных органов"?"/courses":`/courses/${n.courseDTO.course_id}`)},children:[e.jsx("div",{className:`soon-text ${g==="Для правоохранительных органов"?"soon":""}`,children:d("Для правоохранительных органов")}),e.jsxs("div",{className:"image",children:[e.jsx("img",{src:M,alt:p}),e.jsx("div",{className:`status ${u}`,children:u==="available"?d("Доступно"):u==="process"?d("В процессе"):u=="free"?d("Бесплатно"):d("Завершен")})]}),e.jsxs("div",{className:"info",children:[e.jsx("div",{className:"course-name",children:p}),e.jsxs("div",{className:"langAndDuration",children:["РУС"," | ",n.courseDTO.duration]}),e.jsxs("div",{className:"rating",children:[e.jsxs("div",{className:"stars",children:[e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23}),e.jsx(y,{className:"star-icon",size:23})]}),e.jsx("span",{children:(D=n.courseDTO.rating%1===0?((T=n.courseDTO.rating)==null?void 0:T.toFixed(1))+".0":(O=n.courseDTO.rating)==null?void 0:O.toFixed(1))==null?void 0:D.replace(/\.0$/,"")})]}),e.jsxs("div",{className:"type",children:[e.jsx(le,{size:23}),e.jsx("span",{children:n.courseDTO.course_for_member_of_the_system})]})]})]},b)})})]})};export{Xe as default};
